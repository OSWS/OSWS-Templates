!function(t){"function"==typeof define&&define.amd?define(["module","lodash","async"],function(n,e,i){n.exports=t({},e,i)}):"object"==typeof exports&&(module.exports=t({},require("lodash"),require("async")))}(function(t,n,e){return"object"==typeof exports&&!function(n,e,i){t.compile=function(t,i){var r=new n(i,module);return r.filename=i,r.paths=n._nodeModulePaths(e.dirname(i)),r._compile(t,i),r.loaded=!0,r.T},t.include=function(t){var n=e.dirname(i()[1].getFileName()),r=e.normalize(e.join(n,t));return require.cache[r]&&delete require.cache[r],require(r)}}(require("module"),require("path"),require("callsite")),t["static"]=function(){var t=this,n=arguments;for(var e in n)!function(e){t[n[e]]=function(){var i=t.construct();return i[n[e]].apply(i,arguments)}}(e)},function(){t.render=function(i,r,s){if(n.isFunction(i))t.isSyncFunction(i)?r(null,i()):t.isAsyncFunction(i)?i(function(t,n){r(t,n)}):i.prototype instanceof t.Data?i._render(r,s):r(null,i);else if(n.isObject(i))if(i instanceof t.Data)i._render(r,s);else{if(n.isArray(i))var o=[];else var o={};var a=n.keys(i);e.each(a,function(n,e){t.render(i[n],function(t,i){o[n]=i,e(t)},s)},function(t){r(t,o)})}else r(null,i)},t.renderContext=function(t,e,i){i(null,n.template(t,e))},t.renderAttributes=function(e,i,r){t.render(e,function(t,e){if(t)i(t);else{var r="";for(var s in e)r+=n.isNull(e[s])?" "+s:" "+s+'="'+e[s]+'"';i(null,r)}},r)},t.regExpSearch=function(t,n){for(var e=[],i=null;null!=(i=n.exec(t));)i.index===n.lastIndex&&n.lastIndex++,e.push(i);return e},t._renderSelectorRegExp=/(\[)|(\])|#([-\w\d]+)|\.([-\w\d]+)|([\w\d-]+)="(['\w\d\s-:\\\/\.\,\]\[={}<>%@#$%^&*~`]*)"|([\w\d-]+)='(["\w\d\s-:\\\/\.\,\]\[={}<>%@#$%^&*~`]*)'|([\w\d-]+)=([\w\d-:\\\/\.={}<>%@#$%^&*~`]*)|("['\w\d\s-:\\\/\.\,\]\[={}<>%@#$%^&*~`]+")|('["\w\d\s-:\\\/\.\,\]\[={}<>%@#$%^&*~`]+')|([_\w-:\\\/]+)/g,t.renderSelector=function(e,i){var r=t.regExpSearch(i,t._renderSelectorRegExp),s=!1;n.each(r,function(t){if(t[1])return void(s=!0);if(t[2])return void(s=!1);if(s){if(t[9])return void(e[t[9]]=t[10]);if(t[7])return void(e[t[7]]=t[8]);if(t[5])return void(e[t[5]]=t[6]);if(t[13])return void(e[t[13]]=null);if(t[12])return void(e[t[12]]=null);if(t[11])return void(e[t[11]]=null)}else{if(t[3])return void(e.id=t[3]);if(t[4])return void(e["class"]?e["class"]+=" "+t[4]:e["class"]=t[4])}})}}(),function(){t.sync=function(t){var n=function(){return t()};return n.__templatesSync=!0,n.toString=function(){return n()},n},t.isSyncFunction=function(t){return!!t.__templatesSync}}(),function(){t.async=function(t){var e=function(e){var i=!1;t(function(t,r){if(i)throw new Error("Repeated call callback unexpected!");i=!0,n.isFunction(e)&&e(t,r)})};return e.__templatesAsync=!0,e.toString=function(){var t=new Error("Asynchrony can not be converted into synchronicity!");if(e(function(n,e){if(n)throw n;t=e}),n.isObject(t)&&t instanceof Error)throw t;return t},e},t.isAsyncFunction=function(t){return!!t.__templatesAsync}}(),function(){t.Prototype=function(){this._parent=void 0,this._arguments=void 0,this.returner=function(){return this},this.constructor=function(){},this.extend=function(){function e(){if(!(this instanceof t.Prototype)){u=arguments;var i=new e;return i.returner(i)}if(n.isArguments(u)){var s=u;u=void 0}else var s=arguments;this._parent=a,this._arguments=s,r.call(this),n.isFunction(this.constructor)&&this.constructor.apply(this,s)}var i=arguments,r=function(){for(var t in i)n.isFunction(i[t])&&i[t].call(this)},s=[];for(var o in arguments)n.isString(arguments[o])&&s.push(arguments[o]);if(s.length>0)var a=this.extend(function(){var n=this._parent;this._static=function(){n._static.call(this),t["static"].apply(this,s)}}).construct();else var a=this;var u=void 0;return e.prototype=a,n.isFunction(a._static)&&a._static.call(e),e},this._static=function(){this.toString=function(){return""},this.construct=function(){return this.apply(this,arguments)},t["static"].call(this,"extend")}}}(),function(){t.Data=(new t.Prototype).extend("render","_render","toString","prepend","data","append",function(){var e=this._parent;this._data=void 0,this.prepend=function(){return this._data.unshift.apply(this._data,arguments),this},this.data=function(){return this._data=Array.prototype.slice.call(arguments),this},this.append=function(){return this._data.push.apply(this._data,arguments),this},this._context={},this.context=function(){for(var t in arguments)n.extend(this._context,arguments[t]);return this},this.constructor=function(){e.constructor.call(this),this._data=[],n.isArray(this._parent._data)&&(this._data=this._parent._data.slice(0)),this._context={}},this.render=function(){var e=!1,i={};for(var r in arguments)n.isFunction(arguments[r])?e=arguments[r]:n.isObject(arguments[r])&&n.extend(i,arguments[r]);e&&this._render(e,i);var s=this;return t.async(function(t){s._render(t,i)})},this._render=function(e,i){var r=n.extend({},this._context);n.extend(r,i),t.render(this._data,function(n,i){n?e(n):t.render(r,function(n,r){n?e(n):t.renderContext(i.join(""),r,e)},r)},r)},this.toString=function(){return String(this.render())}}),t.data=t.Data.extend(function(){var t=this._parent;this.constructor=function(){t.constructor.apply(this),this.data.apply(this,arguments)}})}(),function(){t.Tag=t.Data.extend("name","attributes","selector",function(){var e=this._parent;this._name=null,this.name=function(t){return this._name=t,this},this._attributes={},this.attributes=function(t){return n.extend(this._attributes,t),this},this.selector=function(n){return t.renderSelector(this._attributes,n),this},this.constructor=function(){e.constructor.call(this),this._attributes=n.isObject(this._parent._attributes)?n.extend({},this._parent._attributes):{};for(var t in arguments)n.isString(arguments[t])?this.selector(arguments[t]):n.isObject(arguments[t])&&this.attributes(arguments[t])},this._renderTag=function(t,n,e,i){i(null,n)},this._render=function(n,i){var r=this;e._render.call(r,function(e,s){e?n(e):t.renderAttributes(r._attributes,function(t,e){t?n(t):r._renderTag(r._name,s,e,n)},i)},i)}})}(),function(){t.Single=t.Tag.extend(function(){this._renderTag=function(t,n,e,i){i(null,"<"+t+e+"/>")}})}(),function(){t._singles=["br","hr","img","input","base","frame","link","meta","style"],t.singles={};for(var n in t._singles)t.singles[t._singles[n]]=t.Single().name(t._singles[n]).extend()}(),function(){t.Double=t.Tag.extend(function(){this.construct=function(){return this()()},this._renderTag=function(t,n,e,i){i(null,"<"+t+e+">"+n+"</"+t+">")},this.returner=function(){var t=this;return t.extend(function(){this.constructor=function(){arguments.length>0&&t.data.apply(t,arguments)},this.returner=function(){return t}})}})}(),function(){t._doubles=["html","body","head","h1","h2","h3","h4","h5","h6","hgroup","div","p","address","blockquote","pre","ul","ol","li","dl","dt","dd","fieldset","legend","form","noscript","object","table","thead","tbody","tfoot","tr","td","th","col","colgroup","caption","span","b","big","strong","i","var","cite","em","q","del","s","strike","tt","code","kbd","samp","small","sub","sup","dfn","bdo","abbr","acronym","a","button","textarea","select","option","article","aside","figcaption","figure","footer","header","section","main","nav","menu","audio","video","embed","canvas","output","details","summary","mark","meter","progress","template","comment","title","script"],t.doubles={};for(var n in t._doubles)t.doubles[t._doubles[n]]=t.Double()().name(t._doubles[n]).extend()}(),function(){t.Doctype=t.Tag.extend(function(){this._name="DOCTYPE",this._renderTag=function(t,n,e,i){i(null,"<!"+t+e+">")}})}(),function(){t.doctypes={},t.doctypes.html=t.Doctype("[html]").extend(),t.doctypes.transitional=t.Doctype('[html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"]').extend(),t.doctypes.strict=t.Doctype('[html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"').extend(),t.doctypes.frameset=t.Doctype('[html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd"]').extend(),t.doctypes.basic=t.Doctype('[html PUBLIC "-//W3C//DTD XHTML Basic 1.1//EN" "http://www.w3.org/TR/xhtml-basic/xhtml-basic11.dtd"]').extend(),t.doctypes.mobile=t.Doctype('[html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.2//EN" "http://www.openmobilealliance.org/tech/DTD/xhtml-mobile12.dtd"]').extend()}(),function(){t.xml=t.Tag.extend(function(){this._name="xml",this._renderTag=function(t,n,e,i){i(null,"<?"+t+e+"?>")}})}(),function(){t.Mixin=t.Data().extend(),t.mixin=function(e){if(!n.isFunction(e))throw new Error("reconstructor must be a function");return t.Mixin().extend(function(){var t=this._parent;this.constructor=function(){t.constructor.apply(this),this.data(e.apply(this,arguments))}})}}(),function(){t.mixins={js:t.mixin(function(e){var i=t.doubles.script('[type="text/javascript"]');if("string"==typeof e)i.attributes({src:e});else{if("function"!=typeof e)throw new Error("Unexpected src.");var r=String(e);i.data(r.substring(r.indexOf("{")+1,r.lastIndexOf("}")))}var s=Array.prototype.slice.call(arguments,1);for(var o in s)n.isString(s[o])?i.selector(s[o]):n.isObject(s[o])&&i.attributes(s[o]);return i}),css:t.mixin(function(e){var i=t.singles.link('[rel="stylesheet"]');if("string"!=typeof e)throw new Error("Unexpected href.");i.attributes({href:e});var r=Array.prototype.slice.call(arguments,1);for(var s in r)n.isString(r[s])?i.selector(r[s]):n.isObject(r[s])&&i.attributes(r[s]);return i})}}(),function(){t["with"]={},t["with"].sync=t.sync,t["with"].async=t.async,t["with"].data=t.data,t["with"].Data=t.Data,t["with"].xml=t.xml,t["with"].doctypes=t.doctypes,t["with"].Doctype=t.Doctype,n.extend(t["with"],t.singles),t["with"].Single=t.Single,n.extend(t["with"],t.doubles),t["with"].Double=t.Double,t["with"].Mixin=t.Mixin,t["with"].mixin=t.mixin,n.extend(t["with"],t.mixins)}(),t});
//# sourceMappingURL=templates.min.js.map