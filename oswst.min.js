!function(t){"function"==typeof define&&define.amd?define(["module","lodash","async"],function(n,e,r){n.exports=t(e,r)}):"object"==typeof exports&&(module.exports=t(require("lodash"),require("async"))),"object"==typeof window&&(window.oswst=t)}(function(t){var n={};return"object"==typeof exports&&!function(t,e,r){n.compile=function(n,r){var i=new t(r,module);return i.filename=r,i.paths=t._nodeModulePaths(e.dirname(r)),i._compile(n,r),i.loaded=!0,i.exports},n.include=function(t){if(e.resolve(t)==e.normalize(t))var n=t;else var i=e.dirname(r()[1].getFileName()),n=e.normalize(e.join(i,t));return require.cache[n]&&delete require.cache[n],require(n)}}(require("module"),require("path"),require("callsite")),n["static"]=function(){var t=this,n=arguments;for(var e in n)!function(e){t[n[e]]=function(){var r=t.construct();return r[n[e]].apply(r,arguments)}}(e)},function(){n.render=function(e,r,i){if(t.isFunction(e))n.isSyncFunction(e)?n.render(e(),r,i):n.isAsyncFunction(e)?e(function(t,e){n.render(e,r,i)}):e.prototype instanceof n.Renderer?e._render(r,i):r(null,e);else if(t.isObject(e))if(e instanceof n.Renderer)e._render(r,i);else{if(t.isArray(e))var s=[];else var s={};var o=t.keys(e),a=0,c=function(){a<o.length?n.render(e[o[a]],function(t,n){t?r(t):(s[o[a]]=n,a++,c())},i):r(null,s)};c()}else r(null,e)},n.renderContext=function(n,e,r){r(null,t.template(n)(e))},n.renderAttributes=function(e,r,i){n.render(e,function(n,e){if(n)r(n);else{var i="";for(var s in e)i+=t.isNull(e[s])?" "+s:" "+s+'="'+e[s]+'"';r(null,i)}},i)},n.regExpSearch=function(t,n){for(var e=[],r=null;null!=(r=n.exec(t));)r.index===n.lastIndex&&n.lastIndex++,e.push(r);return e},n._renderSelectorRegExp=/(\[)|(\])|#([-\w\d]+)|\.([-\w\d]+)|([\w\d-]+)="(['\w\d\s-:\\\/\.\,\]\[={}<>%@#$%^&*~`]*)"|([\w\d-]+)='(["\w\d\s-:\\\/\.\,\]\[={}<>%@#$%^&*~`]*)'|([\w\d-]+)=([\w\d-:\\\/\.={}<>%@#$%^&*~`]*)|("['\w\d\s-:\\\/\.\,\]\[={}<>%@#$%^&*~`]+")|('["\w\d\s-:\\\/\.\,\]\[={}<>%@#$%^&*~`]+')|([_\w-:\\\/]+)/g,n.renderSelector=function(e,r){var i=n.regExpSearch(r,n._renderSelectorRegExp),s=!1;t.each(i,function(t){if(t[1])return void(s=!0);if(t[2])return void(s=!1);if(s){if(t[9])return void(e[t[9]]=t[10]);if(t[7])return void(e[t[7]]=t[8]);if(t[5])return void(e[t[5]]=t[6]);if(t[13])return void(e[t[13]]=null);if(t[12])return void(e[t[12]]=null);if(t[11])return void(e[t[11]]=null)}else{if(t[3])return void(e.id=t[3]);if(t[4])return void(e["class"]?e["class"]+=" "+t[4]:e["class"]=t[4])}})}}(),function(){n.sync=function(e){var r=function(){return e()};return r.__templatesSync=!0,r.toString=function(){var e=new Error("Asynchrony can not be converted into synchronicity!");if(n.render(r,function(t,n){if(t)throw t;e=n},{}),t.isObject(e)&&e instanceof Error)throw e;return e},r},n.isSyncFunction=function(t){return!!t.__templatesSync}}(),function(){n.async=function(e){var r=function(n){if(!n)return r.toString();var i=!1;e(function(e,r){if(i)throw new Error("Repeated call callback unexpected!");i=!0,t.isFunction(n)&&n(e,r)})};return r.__templatesAsync=!0,r.toString=function(){var e=new Error("Asynchrony can not be converted into synchronicity!");if(n.render(r,function(t,n){if(t)throw t;e=n},{}),t.isObject(e)&&e instanceof Error)throw e;return e},r},n.isAsyncFunction=function(t){return!!t.__templatesAsync}}(),function(){n.Prototype=function(){this._parent=void 0,this._arguments=void 0,this.returner=function(){return this},this.constructor=function(){},this.extend=function(){function e(){if(!(this instanceof n.Prototype)){c=arguments;var r=new e;return r.returner(r)}if(t.isArguments(c)){var s=c;c=void 0}else var s=arguments;this._parent=a,this._arguments=s,i.call(this),t.isFunction(this.constructor)&&this.constructor.apply(this,s)}var r=arguments,i=function(){for(var n in r)t.isFunction(r[n])&&r[n].call(this)},s=[];for(var o in arguments)t.isString(arguments[o])&&s.push(arguments[o]);if(s.length>0)var a=this.extend(function(){var t=this._parent;this._static=function(){t._static.call(this),n["static"].apply(this,s)}}).construct();else var a=this;var c=void 0;return e.prototype=a,t.isFunction(a._static)&&a._static.call(e),e},this._static=function(){this.toString=function(){return""},this.construct=function(){return this.apply(this,arguments)},n["static"].call(this,"extend")}}}(),function(){n.Renderer=(new n.Prototype).extend("data","context","render","_render","toString",function(){var e=this._parent;this._data=void 0,this.data=function(t){return this._data=t,this},this._context={},this.context=function(){for(var n in arguments)t.extend(this._context,arguments[n]);return this},this.constructor=function(){e.constructor.call(this),this._context={}},this.render=function(){var e=!1,r={},i=this;for(var s in arguments)t.isFunction(arguments[s])?e=arguments[s]:t.isObject(arguments[s])&&t.extend(r,arguments[s]);var o=n.async(function(t){i._render(t,r)});return e&&o(e),o},this._render=function(e,r){var i=t.extend({},this._context);t.extend(i,r),n.render(this._data,function(r,s){r?e(r):n.render(i,function(r,i){r?e(r):n.renderContext(t.isArray(s)?s.join(""):s,i,e)},i)},i)},this.toString=function(){return String(this.render())}})}(),function(){n.Data=n.Renderer.extend("prepend","append",function(){var n=this._parent;this._data=void 0,this.prepend=function(){return this._data.unshift.apply(this._data,arguments),this},this.data=function(){return this._data=Array.prototype.slice.call(arguments),this},this.append=function(){return this._data.push.apply(this._data,arguments),this},this.constructor=function(){n.constructor.call(this),this._data=[],t.isArray(this._parent._data)&&(this._data=this._parent._data.slice(0))}}),n.data=n.Data.extend(function(){var t=this._parent;this.constructor=function(){t.constructor.apply(this),this.data.apply(this,arguments)}})}(),function(){n.Tag=n.Data.extend("attributes","selector",function(){var e=this._parent;this._name=null,this.name=function(t){return this._name=t,this},this._attributes={},this.attributes=function(n){return t.extend(this._attributes,n),this},this.selector=function(t){return n.renderSelector(this._attributes,t),this},this.constructor=function(){e.constructor.call(this),this._attributes=t.isObject(this._parent._attributes)?t.extend({},this._parent._attributes):{};for(var n in arguments)t.isString(arguments[n])?this.selector(arguments[n]):t.isObject(arguments[n])&&this.attributes(arguments[n])},this._renderTag=function(t,n,e,r){r(null,n)},this._render=function(t,r){var i=this;e._render.call(i,function(e,s){e?t(e):n.renderAttributes(i._attributes,function(n,e){n?t(n):i._renderTag(i._name,s,e,t)},r)},r)}})}(),function(){n.Single=n.Tag.extend(function(){this._renderTag=function(t,n,e,r){r(null,"<"+t+e+"/>")}})}(),function(){n._singles=["br","hr","img","input","base","frame","link","meta","style"],n.singles={};for(var t in n._singles)n.singles[n._singles[t]]=n.Single().name(n._singles[t]).extend()}(),function(){n.Double=n.Tag.extend(function(){this.construct=function(){return this()()},this._renderTag=function(t,n,e,r){r(null,"<"+t+e+">"+n+"</"+t+">")},this.returner=function(){var t=this;return t.extend(function(){this.constructor=function(){arguments.length>0&&t.data.apply(t,arguments)},this.returner=function(){return t}})}})}(),function(){n._doubles=["html","body","head","h1","h2","h3","h4","h5","h6","hgroup","div","p","address","blockquote","pre","ul","ol","li","dl","dt","dd","fieldset","legend","form","noscript","object","table","thead","tbody","tfoot","tr","td","th","col","colgroup","caption","span","b","big","strong","i","var","cite","em","q","del","s","strike","tt","code","kbd","samp","small","sub","sup","dfn","bdo","abbr","acronym","a","button","textarea","select","option","article","aside","figcaption","figure","footer","header","section","main","nav","menu","audio","video","embed","canvas","output","details","summary","mark","meter","progress","template","comment","title","script"],n.doubles={};for(var t in n._doubles)n.doubles[n._doubles[t]]=n.Double()().name(n._doubles[t]).extend()}(),function(){n.Doctype=n.Tag.extend(function(){this._name="DOCTYPE",this._renderTag=function(t,n,e,r){r(null,"<!"+t+e+">")}})}(),function(){n.doctypes={},n.doctypes.html=n.Doctype("[html]").extend(),n.doctypes.transitional=n.Doctype('[html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"]').extend(),n.doctypes.strict=n.Doctype('[html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"').extend(),n.doctypes.frameset=n.Doctype('[html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd"]').extend(),n.doctypes.basic=n.Doctype('[html PUBLIC "-//W3C//DTD XHTML Basic 1.1//EN" "http://www.w3.org/TR/xhtml-basic/xhtml-basic11.dtd"]').extend(),n.doctypes.mobile=n.Doctype('[html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.2//EN" "http://www.openmobilealliance.org/tech/DTD/xhtml-mobile12.dtd"]').extend()}(),function(){n.xml=n.Tag.extend(function(){this._name="xml",this._renderTag=function(t,n,e,r){r(null,"<?"+t+e+"?>")}})}(),function(){n.Mixin=n.Data().extend(),n.mixin=function(e){if(!t.isFunction(e))throw new Error("reconstructor must be a function");return n.Mixin().extend(function(){var t=this._parent;this.constructor=function(){t.constructor.apply(this),this.data(e.apply(this,arguments))}})}}(),function(){n.mixins={js:n.mixin(function(e){var r=n.doubles.script('[type="text/javascript"]');if("string"==typeof e)r.attributes({src:e});else{if("function"!=typeof e)throw new Error("Unexpected src.");var i=String(e);r.data(i.substring(i.indexOf("{")+1,i.lastIndexOf("}")))}var s=Array.prototype.slice.call(arguments,1);for(var o in s)t.isString(s[o])?r.selector(s[o]):t.isObject(s[o])&&r.attributes(s[o]);return r}),css:n.mixin(function(e){var r=n.singles.link('[rel="stylesheet"]');if("string"!=typeof e)throw new Error("Unexpected href.");r.attributes({href:e});var i=Array.prototype.slice.call(arguments,1);for(var s in i)t.isString(i[s])?r.selector(i[s]):t.isObject(i[s])&&r.attributes(i[s]);return r})}}(),function(){n.Module=n.Renderer.extend(function(){var e=this._parent;this.constructor=function(n){e.constructor.call(this),t.isUndefined(n)||(this._data=n)},this.returner=function(){var e=this;return e.extend(function(){var e=this._parent;this.constructor=function(){e.constructor.call(this),t.isFunction(this._data)&&this._data.prototype instanceof n.Mixin&&this.data(this._data.apply(null,arguments))},this.returner=function(){return this}})}})}(),function(){n["with"]={},n["with"].sync=n.sync,n["with"].async=n.async,n["with"].Renderer=n.Renderer,n["with"].data=n.data,n["with"].Data=n.Data,n["with"].xml=n.xml,n["with"].doctypes=n.doctypes,n["with"].Doctype=n.Doctype,t.extend(n["with"],n.singles),n["with"].Single=n.Single,t.extend(n["with"],n.doubles),n["with"].Double=n.Double,n["with"].Mixin=n.Mixin,n["with"].mixin=n.mixin,t.extend(n["with"],n.mixins),n["with"].Module=n.Module}(),n});
//# sourceMappingURL=oswst.min.js.map