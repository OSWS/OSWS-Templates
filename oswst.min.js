!function(t){"function"==typeof define&&define.amd?define(["module","lodash","async"],function(n,e,r){n.exports=t(e,r)}):"object"==typeof exports&&(module.exports=t(require("lodash"),require("async")));var n=function(){return t(arguments)};"object"==typeof window&&(window.oswst=n),"object"==typeof global&&(global.oswst=n)}(function(t,n){var e={};return"object"==typeof exports&&!function(t,n,r){e.compile=function(e,r){var i=new t(r,module);return i.filename=r,i.paths=t._nodeModulePaths(n.dirname(r)),i._compile(e,r),i.loaded=!0,i.exports},e.include=function(t){if(n.resolve(t)==n.normalize(t))var e=t;else var i=n.dirname(r()[1].getFileName()),e=n.normalize(n.join(i,t));return require.cache[e]&&delete require.cache[e],require(e)}}(require("module"),require("path"),require("callsite")),e["static"]=function(){var t=this,n=arguments;for(var e in n)!function(e){t[n[e]]=function(){var r=t.construct();return r[n[e]].apply(r,arguments)}}(e)},function(){e.render=function(r,i,s){if(t.isFunction(r))e.isSyncFunction(r)?e.render(r(),i,s):e.isAsyncFunction(r)?r(function(t,n){e.render(n,i,s)}):r.prototype instanceof e.Renderer?r._render(i,s):i(null,r);else if(t.isObject(r))if(r instanceof e.Renderer)r._render(i,s);else{if(t.isArray(r))var o=[];else var o={};var a=t.keys(r);n.each(a,function(t,n){e.render(r[t],function(e,r){o[t]=r,n(e)},s)},function(t){i(t,o)})}else i(null,r)},e.renderContext=function(n,e,r){r(null,t.template(n,e))},e.renderAttributes=function(n,r,i){e.render(n,function(n,e){if(n)r(n);else{var i="";for(var s in e)i+=t.isNull(e[s])?" "+s:" "+s+'="'+e[s]+'"';r(null,i)}},i)},e.regExpSearch=function(t,n){for(var e=[],r=null;null!=(r=n.exec(t));)r.index===n.lastIndex&&n.lastIndex++,e.push(r);return e},e._renderSelectorRegExp=/(\[)|(\])|#([-\w\d]+)|\.([-\w\d]+)|([\w\d-]+)="(['\w\d\s-:\\\/\.\,\]\[={}<>%@#$%^&*~`]*)"|([\w\d-]+)='(["\w\d\s-:\\\/\.\,\]\[={}<>%@#$%^&*~`]*)'|([\w\d-]+)=([\w\d-:\\\/\.={}<>%@#$%^&*~`]*)|("['\w\d\s-:\\\/\.\,\]\[={}<>%@#$%^&*~`]+")|('["\w\d\s-:\\\/\.\,\]\[={}<>%@#$%^&*~`]+')|([_\w-:\\\/]+)/g,e.renderSelector=function(n,r){var i=e.regExpSearch(r,e._renderSelectorRegExp),s=!1;t.each(i,function(t){if(t[1])return void(s=!0);if(t[2])return void(s=!1);if(s){if(t[9])return void(n[t[9]]=t[10]);if(t[7])return void(n[t[7]]=t[8]);if(t[5])return void(n[t[5]]=t[6]);if(t[13])return void(n[t[13]]=null);if(t[12])return void(n[t[12]]=null);if(t[11])return void(n[t[11]]=null)}else{if(t[3])return void(n.id=t[3]);if(t[4])return void(n["class"]?n["class"]+=" "+t[4]:n["class"]=t[4])}})}}(),function(){e.sync=function(n){var r=function(){return n()};return r.__templatesSync=!0,r.toString=function(){var n=new Error("Asynchrony can not be converted into synchronicity!");if(e.render(r,function(t,e){if(t)throw t;n=e},{}),t.isObject(n)&&n instanceof Error)throw n;return n},r},e.isSyncFunction=function(t){return!!t.__templatesSync}}(),function(){e.async=function(n){var r=function(e){if(!e)return r.toString();var i=!1;n(function(n,r){if(i)throw new Error("Repeated call callback unexpected!");i=!0,t.isFunction(e)&&e(n,r)})};return r.__templatesAsync=!0,r.toString=function(){var n=new Error("Asynchrony can not be converted into synchronicity!");if(e.render(r,function(t,e){if(t)throw t;n=e},{}),t.isObject(n)&&n instanceof Error)throw n;return n},r},e.isAsyncFunction=function(t){return!!t.__templatesAsync}}(),function(){e.Prototype=function(){this._parent=void 0,this._arguments=void 0,this.returner=function(){return this},this.constructor=function(){},this.extend=function(){function n(){if(!(this instanceof e.Prototype)){c=arguments;var r=new n;return r.returner(r)}if(t.isArguments(c)){var s=c;c=void 0}else var s=arguments;this._parent=a,this._arguments=s,i.call(this),t.isFunction(this.constructor)&&this.constructor.apply(this,s)}var r=arguments,i=function(){for(var n in r)t.isFunction(r[n])&&r[n].call(this)},s=[];for(var o in arguments)t.isString(arguments[o])&&s.push(arguments[o]);if(s.length>0)var a=this.extend(function(){var t=this._parent;this._static=function(){t._static.call(this),e["static"].apply(this,s)}}).construct();else var a=this;var c=void 0;return n.prototype=a,t.isFunction(a._static)&&a._static.call(n),n},this._static=function(){this.toString=function(){return""},this.construct=function(){return this.apply(this,arguments)},e["static"].call(this,"extend")}}}(),function(){e.Renderer=(new e.Prototype).extend("data","context","render","_render","toString",function(){var n=this._parent;this._data=void 0,this.data=function(t){return this._data=t,this},this._context={},this.context=function(){for(var n in arguments)t.extend(this._context,arguments[n]);return this},this.constructor=function(){n.constructor.call(this),this._context={}},this.render=function(){var n=!1,r={};for(var i in arguments)t.isFunction(arguments[i])?n=arguments[i]:t.isObject(arguments[i])&&t.extend(r,arguments[i]);n&&this._render(n,r);var s=this;return e.async(function(t){s._render(t,r)})},this._render=function(n,r){var i=t.extend({},this._context);t.extend(i,r),e.render(this._data,function(r,s){r?n(r):e.render(i,function(r,i){r?n(r):e.renderContext(t.isArray(s)?s.join(""):s,i,n)},i)},i)},this.toString=function(){return String(this.render())}})}(),function(){e.Data=e.Renderer.extend("prepend","append",function(){var n=this._parent;this._data=void 0,this.prepend=function(){return this._data.unshift.apply(this._data,arguments),this},this.data=function(){return this._data=Array.prototype.slice.call(arguments),this},this.append=function(){return this._data.push.apply(this._data,arguments),this},this.constructor=function(){n.constructor.call(this),this._data=[],t.isArray(this._parent._data)&&(this._data=this._parent._data.slice(0))}}),e.data=e.Data.extend(function(){var t=this._parent;this.constructor=function(){t.constructor.apply(this),this.data.apply(this,arguments)}})}(),function(){e.Tag=e.Data.extend("attributes","selector",function(){var n=this._parent;this._name=null,this.name=function(t){return this._name=t,this},this._attributes={},this.attributes=function(n){return t.extend(this._attributes,n),this},this.selector=function(t){return e.renderSelector(this._attributes,t),this},this.constructor=function(){n.constructor.call(this),this._attributes=t.isObject(this._parent._attributes)?t.extend({},this._parent._attributes):{};for(var e in arguments)t.isString(arguments[e])?this.selector(arguments[e]):t.isObject(arguments[e])&&this.attributes(arguments[e])},this._renderTag=function(t,n,e,r){r(null,n)},this._render=function(t,r){var i=this;n._render.call(i,function(n,s){n?t(n):e.renderAttributes(i._attributes,function(n,e){n?t(n):i._renderTag(i._name,s,e,t)},r)},r)}})}(),function(){e.Single=e.Tag.extend(function(){this._renderTag=function(t,n,e,r){r(null,"<"+t+e+"/>")}})}(),function(){e._singles=["br","hr","img","input","base","frame","link","meta","style"],e.singles={};for(var t in e._singles)e.singles[e._singles[t]]=e.Single().name(e._singles[t]).extend()}(),function(){e.Double=e.Tag.extend(function(){this.construct=function(){return this()()},this._renderTag=function(t,n,e,r){r(null,"<"+t+e+">"+n+"</"+t+">")},this.returner=function(){var t=this;return t.extend(function(){this.constructor=function(){arguments.length>0&&t.data.apply(t,arguments)},this.returner=function(){return t}})}})}(),function(){e._doubles=["html","body","head","h1","h2","h3","h4","h5","h6","hgroup","div","p","address","blockquote","pre","ul","ol","li","dl","dt","dd","fieldset","legend","form","noscript","object","table","thead","tbody","tfoot","tr","td","th","col","colgroup","caption","span","b","big","strong","i","var","cite","em","q","del","s","strike","tt","code","kbd","samp","small","sub","sup","dfn","bdo","abbr","acronym","a","button","textarea","select","option","article","aside","figcaption","figure","footer","header","section","main","nav","menu","audio","video","embed","canvas","output","details","summary","mark","meter","progress","template","comment","title","script"],e.doubles={};for(var t in e._doubles)e.doubles[e._doubles[t]]=e.Double()().name(e._doubles[t]).extend()}(),function(){e.Doctype=e.Tag.extend(function(){this._name="DOCTYPE",this._renderTag=function(t,n,e,r){r(null,"<!"+t+e+">")}})}(),function(){e.doctypes={},e.doctypes.html=e.Doctype("[html]").extend(),e.doctypes.transitional=e.Doctype('[html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"]').extend(),e.doctypes.strict=e.Doctype('[html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"').extend(),e.doctypes.frameset=e.Doctype('[html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd"]').extend(),e.doctypes.basic=e.Doctype('[html PUBLIC "-//W3C//DTD XHTML Basic 1.1//EN" "http://www.w3.org/TR/xhtml-basic/xhtml-basic11.dtd"]').extend(),e.doctypes.mobile=e.Doctype('[html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.2//EN" "http://www.openmobilealliance.org/tech/DTD/xhtml-mobile12.dtd"]').extend()}(),function(){e.xml=e.Tag.extend(function(){this._name="xml",this._renderTag=function(t,n,e,r){r(null,"<?"+t+e+"?>")}})}(),function(){e.Mixin=e.Data().extend(),e.mixin=function(n){if(!t.isFunction(n))throw new Error("reconstructor must be a function");return e.Mixin().extend(function(){var t=this._parent;this.constructor=function(){t.constructor.apply(this),this.data(n.apply(this,arguments))}})}}(),function(){e.mixins={js:e.mixin(function(n){var r=e.doubles.script('[type="text/javascript"]');if("string"==typeof n)r.attributes({src:n});else{if("function"!=typeof n)throw new Error("Unexpected src.");var i=String(n);r.data(i.substring(i.indexOf("{")+1,i.lastIndexOf("}")))}var s=Array.prototype.slice.call(arguments,1);for(var o in s)t.isString(s[o])?r.selector(s[o]):t.isObject(s[o])&&r.attributes(s[o]);return r}),css:e.mixin(function(n){var r=e.singles.link('[rel="stylesheet"]');if("string"!=typeof n)throw new Error("Unexpected href.");r.attributes({href:n});var i=Array.prototype.slice.call(arguments,1);for(var s in i)t.isString(i[s])?r.selector(i[s]):t.isObject(i[s])&&r.attributes(i[s]);return r})}}(),function(){e.Module=e.Renderer.extend(function(){var n=this._parent;this.constructor=function(e){n.constructor.call(this),t.isUndefined(e)||(this._data=e)},this.returner=function(){var n=this;return n.extend(function(){var n=this._parent;this.constructor=function(){n.constructor.call(this),t.isFunction(this._data)&&this._data.prototype instanceof e.Mixin&&this.data(this._data.apply(null,arguments))},this.returner=function(){return this}})}})}(),function(){e["with"]={},e["with"].sync=e.sync,e["with"].async=e.async,e["with"].Renderer=e.Renderer,e["with"].data=e.data,e["with"].Data=e.Data,e["with"].xml=e.xml,e["with"].doctypes=e.doctypes,e["with"].Doctype=e.Doctype,t.extend(e["with"],e.singles),e["with"].Single=e.Single,t.extend(e["with"],e.doubles),e["with"].Double=e.Double,e["with"].Mixin=e.Mixin,e["with"].mixin=e.mixin,t.extend(e["with"],e.mixins),e["with"].Module=e.Module}(),e});
//# sourceMappingURL=oswst.min.js.map