!function(t){"function"==typeof define&&define.amd?define(["module","lodash","async"],function(n,e,r){n.exports=t({},e,r)}):"object"==typeof exports&&(module.exports=t({},require("lodash"),require("async")));var n=function(){return t({},Array.prototype.slice.call(arguments,1))};"object"==typeof window&&(window.oswst=n),"object"==typeof global&&(global.oswst=n)}(function(t,n,e){return"object"==typeof exports&&!function(n,e,r){t.compile=function(t,r){var i=new n(r,module);return i.filename=r,i.paths=n._nodeModulePaths(e.dirname(r)),i._compile(t,r),i.loaded=!0,i.exports},t.include=function(t){if(e.resolve(t)==e.normalize(t))var n=t;else var i=e.dirname(r()[1].getFileName()),n=e.normalize(e.join(i,t));return require.cache[n]&&delete require.cache[n],require(n)}}(require("module"),require("path"),require("callsite")),t["static"]=function(){var t=this,n=arguments;for(var e in n)!function(e){t[n[e]]=function(){var r=t.construct();return r[n[e]].apply(r,arguments)}}(e)},function(){t.render=function(r,i,s){if(n.isFunction(r))t.isSyncFunction(r)?t.render(r(),i,s):t.isAsyncFunction(r)?r(function(n,e){t.render(e,i,s)}):r.prototype instanceof t.Renderer?r._render(i,s):i(null,r);else if(n.isObject(r))if(r instanceof t.Renderer)r._render(i,s);else{if(n.isArray(r))var o=[];else var o={};var a=n.keys(r);e.each(a,function(n,e){t.render(r[n],function(t,r){o[n]=r,e(t)},s)},function(t){i(t,o)})}else i(null,r)},t.renderContext=function(t,e,r){r(null,n.template(t,e))},t.renderAttributes=function(e,r,i){t.render(e,function(t,e){if(t)r(t);else{var i="";for(var s in e)i+=n.isNull(e[s])?" "+s:" "+s+'="'+e[s]+'"';r(null,i)}},i)},t.regExpSearch=function(t,n){for(var e=[],r=null;null!=(r=n.exec(t));)r.index===n.lastIndex&&n.lastIndex++,e.push(r);return e},t._renderSelectorRegExp=/(\[)|(\])|#([-\w\d]+)|\.([-\w\d]+)|([\w\d-]+)="(['\w\d\s-:\\\/\.\,\]\[={}<>%@#$%^&*~`]*)"|([\w\d-]+)='(["\w\d\s-:\\\/\.\,\]\[={}<>%@#$%^&*~`]*)'|([\w\d-]+)=([\w\d-:\\\/\.={}<>%@#$%^&*~`]*)|("['\w\d\s-:\\\/\.\,\]\[={}<>%@#$%^&*~`]+")|('["\w\d\s-:\\\/\.\,\]\[={}<>%@#$%^&*~`]+')|([_\w-:\\\/]+)/g,t.renderSelector=function(e,r){var i=t.regExpSearch(r,t._renderSelectorRegExp),s=!1;n.each(i,function(t){if(t[1])return void(s=!0);if(t[2])return void(s=!1);if(s){if(t[9])return void(e[t[9]]=t[10]);if(t[7])return void(e[t[7]]=t[8]);if(t[5])return void(e[t[5]]=t[6]);if(t[13])return void(e[t[13]]=null);if(t[12])return void(e[t[12]]=null);if(t[11])return void(e[t[11]]=null)}else{if(t[3])return void(e.id=t[3]);if(t[4])return void(e["class"]?e["class"]+=" "+t[4]:e["class"]=t[4])}})}}(),function(){t.sync=function(e){var r=function(){return e()};return r.__templatesSync=!0,r.toString=function(){var e=new Error("Asynchrony can not be converted into synchronicity!");if(t.render(r,function(t,n){if(t)throw t;e=n},{}),n.isObject(e)&&e instanceof Error)throw e;return e},r},t.isSyncFunction=function(t){return!!t.__templatesSync}}(),function(){t.async=function(e){var r=function(t){if(!t)return r.toString();var i=!1;e(function(e,r){if(i)throw new Error("Repeated call callback unexpected!");i=!0,n.isFunction(t)&&t(e,r)})};return r.__templatesAsync=!0,r.toString=function(){var e=new Error("Asynchrony can not be converted into synchronicity!");if(t.render(r,function(t,n){if(t)throw t;e=n},{}),n.isObject(e)&&e instanceof Error)throw e;return e},r},t.isAsyncFunction=function(t){return!!t.__templatesAsync}}(),function(){t.Prototype=function(){this._parent=void 0,this._arguments=void 0,this.returner=function(){return this},this.constructor=function(){},this.extend=function(){function e(){if(!(this instanceof t.Prototype)){c=arguments;var r=new e;return r.returner(r)}if(n.isArguments(c)){var s=c;c=void 0}else var s=arguments;this._parent=a,this._arguments=s,i.call(this),n.isFunction(this.constructor)&&this.constructor.apply(this,s)}var r=arguments,i=function(){for(var t in r)n.isFunction(r[t])&&r[t].call(this)},s=[];for(var o in arguments)n.isString(arguments[o])&&s.push(arguments[o]);if(s.length>0)var a=this.extend(function(){var n=this._parent;this._static=function(){n._static.call(this),t["static"].apply(this,s)}}).construct();else var a=this;var c=void 0;return e.prototype=a,n.isFunction(a._static)&&a._static.call(e),e},this._static=function(){this.toString=function(){return""},this.construct=function(){return this.apply(this,arguments)},t["static"].call(this,"extend")}}}(),function(){t.Renderer=(new t.Prototype).extend("data","context","render","_render","toString",function(){var e=this._parent;this._data=void 0,this.data=function(t){return this._data=t,this},this._context={},this.context=function(){for(var t in arguments)n.extend(this._context,arguments[t]);return this},this.constructor=function(){e.constructor.call(this),this._context={}},this.render=function(){var e=!1,r={};for(var i in arguments)n.isFunction(arguments[i])?e=arguments[i]:n.isObject(arguments[i])&&n.extend(r,arguments[i]);e&&this._render(e,r);var s=this;return t.async(function(t){s._render(t,r)})},this._render=function(e,r){var i=n.extend({},this._context);n.extend(i,r),t.render(this._data,function(r,s){r?e(r):t.render(i,function(r,i){r?e(r):t.renderContext(n.isArray(s)?s.join(""):s,i,e)},i)},i)},this.toString=function(){return String(this.render())}})}(),function(){t.Data=t.Renderer.extend("prepend","append",function(){var t=this._parent;this._data=void 0,this.prepend=function(){return this._data.unshift.apply(this._data,arguments),this},this.data=function(){return this._data=Array.prototype.slice.call(arguments),this},this.append=function(){return this._data.push.apply(this._data,arguments),this},this.constructor=function(){t.constructor.call(this),this._data=[],n.isArray(this._parent._data)&&(this._data=this._parent._data.slice(0))}}),t.data=t.Data.extend(function(){var t=this._parent;this.constructor=function(){t.constructor.apply(this),this.data.apply(this,arguments)}})}(),function(){t.Tag=t.Data.extend("attributes","selector",function(){var e=this._parent;this._name=null,this.name=function(t){return this._name=t,this},this._attributes={},this.attributes=function(t){return n.extend(this._attributes,t),this},this.selector=function(n){return t.renderSelector(this._attributes,n),this},this.constructor=function(){e.constructor.call(this),this._attributes=n.isObject(this._parent._attributes)?n.extend({},this._parent._attributes):{};for(var t in arguments)n.isString(arguments[t])?this.selector(arguments[t]):n.isObject(arguments[t])&&this.attributes(arguments[t])},this._renderTag=function(t,n,e,r){r(null,n)},this._render=function(n,r){var i=this;e._render.call(i,function(e,s){e?n(e):t.renderAttributes(i._attributes,function(t,e){t?n(t):i._renderTag(i._name,s,e,n)},r)},r)}})}(),function(){t.Single=t.Tag.extend(function(){this._renderTag=function(t,n,e,r){r(null,"<"+t+e+"/>")}})}(),function(){t._singles=["br","hr","img","input","base","frame","link","meta","style"],t.singles={};for(var n in t._singles)t.singles[t._singles[n]]=t.Single().name(t._singles[n]).extend()}(),function(){t.Double=t.Tag.extend(function(){this.construct=function(){return this()()},this._renderTag=function(t,n,e,r){r(null,"<"+t+e+">"+n+"</"+t+">")},this.returner=function(){var t=this;return t.extend(function(){this.constructor=function(){arguments.length>0&&t.data.apply(t,arguments)},this.returner=function(){return t}})}})}(),function(){t._doubles=["html","body","head","h1","h2","h3","h4","h5","h6","hgroup","div","p","address","blockquote","pre","ul","ol","li","dl","dt","dd","fieldset","legend","form","noscript","object","table","thead","tbody","tfoot","tr","td","th","col","colgroup","caption","span","b","big","strong","i","var","cite","em","q","del","s","strike","tt","code","kbd","samp","small","sub","sup","dfn","bdo","abbr","acronym","a","button","textarea","select","option","article","aside","figcaption","figure","footer","header","section","main","nav","menu","audio","video","embed","canvas","output","details","summary","mark","meter","progress","template","comment","title","script"],t.doubles={};for(var n in t._doubles)t.doubles[t._doubles[n]]=t.Double()().name(t._doubles[n]).extend()}(),function(){t.Doctype=t.Tag.extend(function(){this._name="DOCTYPE",this._renderTag=function(t,n,e,r){r(null,"<!"+t+e+">")}})}(),function(){t.doctypes={},t.doctypes.html=t.Doctype("[html]").extend(),t.doctypes.transitional=t.Doctype('[html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"]').extend(),t.doctypes.strict=t.Doctype('[html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"').extend(),t.doctypes.frameset=t.Doctype('[html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd"]').extend(),t.doctypes.basic=t.Doctype('[html PUBLIC "-//W3C//DTD XHTML Basic 1.1//EN" "http://www.w3.org/TR/xhtml-basic/xhtml-basic11.dtd"]').extend(),t.doctypes.mobile=t.Doctype('[html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.2//EN" "http://www.openmobilealliance.org/tech/DTD/xhtml-mobile12.dtd"]').extend()}(),function(){t.xml=t.Tag.extend(function(){this._name="xml",this._renderTag=function(t,n,e,r){r(null,"<?"+t+e+"?>")}})}(),function(){t.Mixin=t.Data().extend(),t.mixin=function(e){if(!n.isFunction(e))throw new Error("reconstructor must be a function");return t.Mixin().extend(function(){var t=this._parent;this.constructor=function(){t.constructor.apply(this),this.data(e.apply(this,arguments))}})}}(),function(){t.mixins={js:t.mixin(function(e){var r=t.doubles.script('[type="text/javascript"]');if("string"==typeof e)r.attributes({src:e});else{if("function"!=typeof e)throw new Error("Unexpected src.");var i=String(e);r.data(i.substring(i.indexOf("{")+1,i.lastIndexOf("}")))}var s=Array.prototype.slice.call(arguments,1);for(var o in s)n.isString(s[o])?r.selector(s[o]):n.isObject(s[o])&&r.attributes(s[o]);return r}),css:t.mixin(function(e){var r=t.singles.link('[rel="stylesheet"]');if("string"!=typeof e)throw new Error("Unexpected href.");r.attributes({href:e});var i=Array.prototype.slice.call(arguments,1);for(var s in i)n.isString(i[s])?r.selector(i[s]):n.isObject(i[s])&&r.attributes(i[s]);return r})}}(),function(){t.Module=t.Renderer.extend(function(){var e=this._parent;this.constructor=function(t){e.constructor.call(this),n.isUndefined(t)||(this._data=t)},this.returner=function(){var e=this;return e.extend(function(){var e=this._parent;this.constructor=function(){e.constructor.call(this),n.isFunction(this._data)&&this._data.prototype instanceof t.Mixin&&this.data(this._data.apply(null,arguments))},this.returner=function(){return this}})}})}(),function(){t["with"]={},t["with"].sync=t.sync,t["with"].async=t.async,t["with"].Renderer=t.Renderer,t["with"].data=t.data,t["with"].Data=t.Data,t["with"].xml=t.xml,t["with"].doctypes=t.doctypes,t["with"].Doctype=t.Doctype,n.extend(t["with"],t.singles),t["with"].Single=t.Single,n.extend(t["with"],t.doubles),t["with"].Double=t.Double,t["with"].Mixin=t.Mixin,t["with"].mixin=t.mixin,n.extend(t["with"],t.mixins),t["with"].Module=t.Module}(),t});
//# sourceMappingURL=oswst.min.js.map